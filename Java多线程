CAS原理
CAS是英文单词CompareAndSwap的缩写，即比较并替换，是一种实现并发算法试尝用到的技术。CAS需要有3个操作数：内存地址V，旧的预期值A，即将要更新的目标值B。

示例代码：
public class VolatileTest {
    static int data = 0;
    public static void main(String[] args) {
        IntStream.range(0, 2).forEach((i) -> {
            new Thread(() -> {
                try {
                    Thread.sleep(20);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                IntStream.range(0, 100).forEach(y -> {
                    data++;
                });
            }).start();

        });
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println(data);
    }
}
测试结果：
> Task :VolatileTest.main()
104
结果分析：上述代码线程1，和线程2分别对data自增，结果在IDEA上运行每次的结果都不是200，这是由于两个线程同时操作了共享变量导致结果不正常，即是线程不安全。

解决方案一：使用synchronized对自增代码进行加锁
//类中定义Object对象，创建一个锁对象
static Object lock = new Object();
IntStream.range(0, 100).forEach(y -> {
    synchronized (lock.getClass()) {
        data++;
    }
});
测试结果：
> Task :VolatileTest.main()
200
结果分析：对自增代码加synchronized关键字，县城内使用同步代码块，由JVM自身的机制来保障线程的安全，缺点是效率比较慢。

使用Lock锁
解决方案二：使用Lock锁
//定义一个lock，用lock自带的加锁和解锁操作，来保证线程安全
static ReentrantLock reentrantLock = new ReentrantLock();

reentrantLock.lock();
data++;
reentrantLock.unlock();
执行结果：
> Task :VolatileTest.main()
200
结果分析：高并发场景下，使用Lock锁要比使用synchronized关键字新能就得到极大提高，Lock底层是通过AQS+CAS机制来实现，缺点是一旦unlock()方法使用不规范，可能导致死锁问题。

解决方案三：使用Atomic原子类实现自增
static AtomicInteger atomicData = new AtomicInteger();
atomicData.incrementAndGet();
执行结果：
> Task :VolatileTest.main()
200
结果分析：在并发量不大的情况下，AtomicInteger比Lock更加安全，性能也能接受。通过JVM底层机制来保证，自动释放锁，无需手动释放。

解决方案四：使用LongAdder原子类，实现方式和方案三类似
//成员变量
static LongAdder longAdderData = new LongAdder();
longAdderData.increment();
执行结果：
> Task :VolatileTest.main()
200
结果分析：LongAdder是JDK1.8中新增的类，和AtomicInteger原子类相似，都是java.util.concurrent.atomic 并发包下的。LongAdder适合高并发长江，特别是写大于读的场景，代价是消耗更多空间。

CAS原理分析：
本次着重由方案三中的AtomicInteger原子类如手，来分析CAS
打开AtomicInteger的incrementAndGet()方法，该方法调用的compareAndSwapInt()方法


